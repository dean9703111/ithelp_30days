#### [å›ç›®éŒ„](../README.md)
## Day14 try-catchè®“ç¨‹å¼æ›´ç©©å®š

ğŸ¤” å›æ†¶ä¸€ä¸‹æˆ‘å€‘ä¹‹å‰çš„æ‡‰ç”¨å ´æ™¯
----
åœ¨[Day7 selenium-çˆ¬èŸ²èµ·æ‰‹å¼](../day7/README.md)æœ‰ä½¿ç”¨åˆ°try-catchä¾†**è§£æ±ºå¦‚æœæŠ“ä¸åˆ°chrome driverçš„ä¾‹å¤–äº‹ä»¶**ï¼Œä»Šå¤©æˆ‘å€‘æœƒæ›´æ¸…æ¥šçš„èªªæ˜å¦‚ä½•**è®“try-catchå¹«åŠ©ä½ æ›´é«˜æ•ˆçš„debugä»¥åŠå¢åŠ ç¨‹å¼ç©©å®šæ€§**  

ğŸ† ä»Šæ—¥ç›®æ¨™
----
1. äº†è§£ä»€éº¼æƒ…å¢ƒä¸‹éœ€è¦ç”¨åˆ°try-catch
2. åœ¨å°ˆæ¡ˆä¸­æ‡‰ç”¨try-catchå¯¦ä½œ
    1. ç™»å…¥Instagramçš„å‡½å¼ï¼šloginInstagram
    2. å‰å¾€Instagramå¸³è™Ÿçš„å‡½å¼ï¼šgoFansPage
    3. ç²å–Instagramå¸³è™Ÿè¿½è¹¤äººæ•¸çš„å‡½å¼ï¼šgetTrace

ğŸ¤” ä»€éº¼æƒ…å¢ƒä¸‹éœ€è¦ç”¨åˆ°try-catch?
----
* ç¨‹å¼åœ¨ç¼ºä¹try-catchçš„æ©Ÿåˆ¶ä¸‹æ˜¯éå¸¸è„†è½çš„ï¼Œåªè¦ç™¼ç”Ÿä¾‹å¤–äº‹ä»¶å°±å®¹æ˜“å´©æ½°ï¼Œä¸‹é¢è®“æˆ‘èˆ‰ä¾‹è®“ç¨‹å¼å´©æ½°æˆ–æ˜¯å¡ä½çš„æ–¹å¼ï¼š  
    1. æŠŠFacebookè·ŸInstagramç™»å…¥ç¶²å€æ”¹æˆä¸å­˜åœ¨çš„ç¶²å€ &rarr; æœƒå› ç‚ºç¶²é ä¸å­˜åœ¨è€Œå¡åœ¨é‚£å€‹ç•«é¢
    2. æŠŠç²‰å°ˆçš„ç¶²å€æ”¹æˆä¸å­˜åœ¨çš„ç¶²å€ &rarr; æœƒå› ç‚ºç„¡æ³•æŠ“åˆ°è¦è®€å–çš„å…ƒä»¶è€Œå´©æ½°
    3. æŠŠç²‰å°ˆçš„ç¶²å€æ”¹æˆä¸å­˜åœ¨çš„ç²‰å°ˆ(æˆ–æ˜¯ç§»é™¤çš„ç²‰å°ˆ) &rarr; æœƒå› ç‚ºç„¡æ³•æŠ“åˆ°è¦è®€å–çš„å…ƒä»¶è€Œå´©æ½°

* ç‚ºäº†é¿å…é€™äº›æ‚²åŠ‡çš„ç™¼ç”Ÿï¼Œtry-catchå°±æ˜¯æˆ‘å€‘çš„å¥½æœ‹å‹ï¼Œä»¥ä¸‹æ˜¯æ‡‰ç”¨ä¸Šè¦æ³¨æ„çš„åœ°æ–¹ï¼š  
    1. **ä¸€å€‹try-catchçš„å€å¡Šä¸è¦åˆ¤æ–·å¤šå€‹ä¸ç›¸é—œçš„äº‹ä»¶**
        * èˆ‡[ä¸Šä¸€ç¯‡é‡æ§‹](/day13/README.md)æåˆ°çš„æ¦‚å¿µé¡ä¼¼ï¼Œä¸€å€‹å‡½å¼å°ˆæ³¨åšå¥½ä¸€ä»¶äº‹ï¼Œtry-catchä¹Ÿæ˜¯å°ˆæ³¨åœ¨ç¢ºèªé€™ä¸€ä»¶äº‹åŸ·è¡Œæ™‚æœ‰æ²’æœ‰ç™¼ç”Ÿæ„å¤–
    2. **é™¤äº†ç³»çµ±è‡ªè¡Œåå‡ºçš„exceptionä»¥å¤–ï¼Œå»ºè­°ä½ ä¹Ÿè¦åŠ ä¸Šconsole.error('æˆ‘åœ¨å“ªå€‹æ­¥é©ŸéŒ¯äº†')**
        * åœ¨ç¨‹å¼çµæ§‹é¾å¤§ä¸”é•·æ™‚é–“åŸ·è¡Œçš„ç‹€æ…‹ä¸‹ï¼Œç³»çµ±åå‡ºçš„exceptionæœ‰æ™‚å¤šåˆ°ä½ çœ¼èŠ±ï¼Œé€™æ™‚ä½ æ’°å¯«çš„console.errorå¯ä»¥å¹«åŠ©ä½ å°ç™¼ç”ŸéŒ¯èª¤çš„ä½ç½®å¿«é€Ÿå®šä½
    3. **ç¨‹å¼éœ€è¦è¨­è¨ˆä¸­æ–·é‚è¼¯é¿å…é€²å…¥ç„¡çª®çš„ç­‰å¾…**
        * æˆ‘å€‘åœ¨æŠ“ç¶²é å…ƒä»¶æ™‚ç”¨äº†wait...untilçš„çµæ§‹ï¼Œå¦‚æœæˆ‘å€‘æ²’æœ‰è¨­å®šæœ€å¤šç­‰å¾…å¹¾ç§’ï¼Œä½ ç­‰åˆ°å¤©è’åœ°è€ï¼Œå› ç‚ºä»–æ°¸é åœåœ¨tryçš„å€å¡Šå‡ºä¸å»ï¼Œæ‰€ä»¥try-catchä¹Ÿå¹«ä¸äº†ä½ 
    4. **é€éä¾‹å¤–è™•ç†æ¸›å°‘å¤šé¤˜çš„æ­¥é©Ÿ**
        * åƒæ˜¯Instagramæˆ‘å€‘ä¸€å®šè¦ç™»å…¥å¾Œæ‰èƒ½çˆ¬èŸ²ï¼Œæ‰€ä»¥æˆ‘å€‘å°±å¯ä»¥è¨­å®šç•¶ç™»å…¥å¤±æ•—æ™‚(è®“å‡½å¼return false)ä¸æœƒåŸ·è¡Œå¾ŒçºŒæ­¥é©Ÿ

ğŸ•¸ï¸åœ¨å°ˆæ¡ˆä¸­æ‡‰ç”¨try-catchå¯¦ä½œ
----
å¯¦è¸å‡ºçœŸçŸ¥ï¼Œä¸‹é¢ä»¥IGçˆ¬èŸ²èˆ‰ä¾‹ï¼Œæˆ‘æœƒå°‡æ¯å€‹å‡½å¼æŠ½å‡ºä¾†é€ä¸€è¬›è§£ï¼Œä¸¦é€éåƒæ•¸çš„èª¿æ•´è®“ä½ ç†è§£try-catchçš„é‹ä½œé‚è¼¯ï¼Œå¤§å®¶ç†è§£å¾Œå¯ä»¥å˜—è©¦ä¿®æ”¹FBçˆ¬èŸ²çš„éƒ¨åˆ†(ç•¶ç„¶æ–‡æœ«çš„åŸå§‹ç¢¼é‚„æ˜¯æœ‰å®Œæ•´è§£ç­”å•¦ğŸ˜…)
1. **ç™»å…¥Instagramçš„å‡½å¼ï¼šloginInstagram**
    * ğŸ˜±è®“ç¨‹å¼åŸ·è¡Œæ™‚å¡ä½çš„æ“ä½œ
        1. æŠŠIGçš„ç™»å…¥ç¶²å€æ”¹æˆéç¶²å€æ ¼å¼çš„å­—ä¸²(å¦‚ï¼š'error')
            * ç¨‹å¼æœƒcrash
        2. æŠŠIGçš„ç™»å…¥ç¶²å€æ”¹æˆå…¶ä»–ç¶²å€
            * æ‰¾ä¸åˆ°ç¶²é ä¸Šå¸³è™Ÿå¯†ç¢¼çš„æ–‡å­—è¼¸å…¥æ¡†ã€é»æ“Šç™»å…¥çš„æŒ‰éˆ•å…ƒä»¶
        3. è¼¸å…¥éŒ¯èª¤çš„ç™»å…¥å¸³å¯†
            * å› ç‚ºç™»å…¥å¤±æ•—ç¶²é å³ä¸Šè§’æ°¸é ä¸æœƒå‡ºç¾é ­åƒå…ƒä»¶
    * ğŸ‘Œè§£æ±ºæ–¹å¼
        1. æŠŠé€™æ®µç™»å…¥çš„é‚è¼¯ç”¨try-catchåŒ…èµ·ä¾†
        2. åŸ·è¡ŒæˆåŠŸæ™‚å›å‚³trueï¼Œå¦‚æœåŸ·è¡Œä¸Šç™¼ç”ŸéŒ¯èª¤å‰‡å›å‚³falseï¼Œçµ‚æ­¢å¾ŒçºŒçˆ¬èŸ²å‹•ä½œ
        3. ç‚ºdriver.waitåŠ ä¸Šåˆç†çš„ç­‰å¾…æ™‚é–“(3ç§’é˜)
        >PS.åœ¨ç¨‹å¼çš„ä¸–ç•Œä¸­é€šå¸¸æ™‚é–“éƒ½æ˜¯ä»¥æ¯«ç§’ç‚ºå–®ä½ï¼Œæ‰€ä»¥æˆ‘å€‘å¡«ä¸Š3000
        
        ```js
        async function loginInstagram (driver) {
            const web = 'https://www.instagram.com/accounts/login';//å‰å¾€IGç™»å…¥é é¢
            try {
                await driver.get(web)//åœ¨é€™è£¡è¦ç”¨awaitç¢ºä¿æ‰“é–‹å®Œç¶²é å¾Œæ‰èƒ½ç¹¼çºŒå‹•ä½œ

                //å¡«å…¥igç™»å…¥è³‡è¨Š
                let ig_username_ele = await driver.wait(until.elementLocated(By.css("input[name='username']")), 3000);
                ig_username_ele.sendKeys(ig_username)
                let ig_password_ele = await driver.wait(until.elementLocated(By.css("input[name='password']")), 3000);
                ig_password_ele.sendKeys(ig_userpass)

                //æŠ“åˆ°ç™»å…¥æŒ‰éˆ•ç„¶å¾Œé»æ“Š
                const login_elem = await driver.wait(until.elementLocated(By.css("button[type='submit']")), 3000)
                login_elem.click()

                //ç™»å…¥å¾Œæ‰æœƒæœ‰å³ä¸Šè§’çš„é ­åƒï¼Œæˆ‘å€‘ä»¥é€™å€‹ä¾†åˆ¤æ–·æ˜¯å¦ç™»å…¥
                await driver.wait(until.elementLocated(By.xpath(`//*[@id="react-root"]//*[contains(@class,"_47KiJ")]`)), 3000)
                return true
            } catch (e) {
                console.error('IGç™»å…¥å¤±æ•—')
                console.error(e)
                return false
            }
        }
        ```
    * ğŸ†—å¯¦éš›æ¸¬è©¦ç¢ºèªçµæœæ˜¯å¦ç¬¦åˆé æœŸ
        1. å°‡ **const web = 'https://www.instagram.com/accounts/login';** é€™æ®µæ”¹ç‚º **const web = 'error';** 
            *  æœƒå› ä¸ç¬¦åˆç¶²å€æ ¼å¼è·³éŒ¯èª¤è¨Šæ¯
            ![image](./article_img/err_ig_terminal1.png)
        2. å°‡ **const web = 'https://www.instagram.com/accounts/login';** é€™æ®µæ”¹ç‚º **const web = 'https://www.google.com';**          
            * æœƒå› æ‰¾ä¸åˆ°ä½¿ç”¨è€…è¼¸å…¥æ¡†å…ƒä»¶è¶…æ™‚è€Œè·³éŒ¯èª¤è¨Šæ¯  
            ![image](./article_img/err_ig_terminal2.png)
        3. æŠŠ.envç’°å¢ƒæª”è£¡é¢çš„ç™»å…¥å¸³è™Ÿå¯†ç¢¼æ”¹æˆéŒ¯èª¤çš„
            * æœƒå› æ‰¾ä¸åˆ°é ­åƒå…ƒä»¶è¶…æ™‚è€Œè·³éŒ¯èª¤è¨Šæ¯
            ![image](./article_img/err_ig_terminal3.png)
            <br>
2. **å‰å¾€Instagramå¸³è™Ÿçš„å‡½å¼ï¼šgoFansPage**
    * ğŸ˜±è®“ç¨‹å¼åŸ·è¡Œæ™‚å¡ä½çš„æ“ä½œ
        1. å‚³å…¥çš„**web_url**æ”¹æˆéç¶²å€æ ¼å¼çš„å­—ä¸²(å¦‚ï¼š'error_page')
            * ç¨‹å¼æœƒcrash
    * ğŸ‘Œè§£æ±ºæ–¹å¼
        1. æŠŠé€™æ®µç™»å…¥çš„é‚è¼¯ç”¨try-catchåŒ…èµ·ä¾†
    ```js
    async function goFansPage (driver, web_url) {
        //ç™»å…¥æˆåŠŸå¾Œè¦å‰å¾€ç²‰å°ˆé é¢
        try {
            await driver.get(web_url)
        } catch (e) {
            console.error('ç„¡æ•ˆçš„ç¶²å€')
            console.error(e)
            return false
        }
    }
    ```
    * ğŸ†—å¯¦éš›æ¸¬è©¦ç¢ºèªçµæœæ˜¯å¦ç¬¦åˆé æœŸ
        1. å°‡ **const fanpage = "https://www.instagram.com/baobaonevertell/"** æ”¹ç‚ºéç¶²å€æ ¼å¼çš„å­—ä¸² **const fanpage = "error_page"** 
            *  æœƒå› ä¸ç¬¦åˆç¶²å€æ ¼å¼è·³éŒ¯èª¤è¨Šæ¯
            ![image](./article_img/err_ig_terminal5.png)       
            <br>   
3. **ç²å–Instagramå¸³è™Ÿè¿½è¹¤äººæ•¸çš„å‡½å¼ï¼šgetTrace**
    * ğŸ˜±è®“ç¨‹å¼åŸ·è¡Œæ™‚å¡ä½çš„æ“ä½œ
        1. ä¸Šä¸€æ­¥goFansPageçš„å‡½å¼å°å‘çš„ä¸¦éInstagramå¸³è™Ÿç¶²å€ï¼Œæˆ–è€…è©²IGå¸³è™Ÿä¸å­˜åœ¨æ™‚
            * æ‰¾ä¸åˆ°ç¶²é ä¸Šè¿½è¹¤äººæ•¸çš„å…ƒä»¶
            ![image](./article_img/err_instagram.png)        
    * ğŸ‘Œè§£æ±ºæ–¹å¼
        1. æŠŠé€™æ®µç™»å…¥çš„é‚è¼¯ç”¨try-catchåŒ…èµ·ä¾†
        2. ç‚ºdriver.waitåŠ ä¸Šåˆç†çš„ç­‰å¾…æ™‚é–“(3ç§’é˜)
        ```js
        async function getTrace (driver) {
            let ig_trace = 0;//é€™æ˜¯ç´€éŒ„IGè¿½è¹¤äººæ•¸
            try {
                const ig_trace_xpath = `//*[@id="react-root"]/section/main/div/header/section/ul/li[2]/a/span`
                const ig_trace_ele = await driver.wait(until.elementLocated(By.xpath(ig_trace_xpath)), 5000)//æˆ‘å€‘æ¡å–5ç§’å…§å¦‚æœæŠ“ä¸åˆ°è©²å…ƒä»¶å°±è·³å‡ºçš„æ¢ä»¶    
                // igå› ç‚ºç•¶äººæ•¸ç ´è¬æ™‚æ–‡å­—ä¸æœƒé¡¯ç¤ºï¼Œæ‰€ä»¥æ”¹æŠ“title
                ig_trace = await ig_trace_ele.getAttribute('title')
                ig_trace = ig_trace.replace(/\D/g, '')//åªå–æ•¸å­—

                return ig_trace
            } catch (e) {
                console.error('ç„¡æ³•æŠ“å–IGè¿½è¹¤äººæ•¸')
                console.error(e)
                return null
            }
        }
        ```
    * ğŸ†—å¯¦éš›æ¸¬è©¦ç¢ºèªçµæœæ˜¯å¦ç¬¦åˆé æœŸ
        1. å°‡ **const fanpage = "https://www.instagram.com/baobaonevertell/"** æ”¹ç‚ºéç¶²å€æ ¼å¼çš„å­—ä¸² **const fanpage = "https://www.instagram.com/error_page_ex/"** 
            *  æœƒå› æ‰¾ä¸åˆ°è¿½è¹¤äººæ•¸çš„å…ƒä»¶è€Œè·³éŒ¯èª¤è¨Šæ¯
            ![image](./article_img/err_ig_terminal6.png)
    

>**ç­†è€…ç¢ç¢å¿µ**  
try-catchçš„æ©Ÿåˆ¶åœ¨ç¨‹å¼è¶Šé¾å¤§çš„è¶Šé‡è¦ï¼Œå› ç‚ºéš¨è‘—é–‹ç™¼çš„æ™‚é–“è»¸æ‹‰çš„è¶Šé•·ï¼Œä½ å°éå»æ’°å¯«çš„ç¨‹å¼æŒæ¡åº¦æœƒè¶Šä¾†è¶Šä½ï¼Œç”šè‡³æœƒå¿˜è¨˜è‡ªå·±æ›¾ç¶“å¯«äº†é€™ä¸€æ®µç¨‹å¼ç¢¼ï¼›è¬ä¸€åœ¨é™é çš„æŸä¸€å¤©é‹è½‰å¥½å¥½çš„ç¨‹å¼çªç„¶å´©æ½°äº†ï¼Œæ²’æœ‰æ’°å¯«try-catchçš„äººåœ¨debugæœƒæµªè²»éå¸¸å¤šçš„æ™‚é–“ï¼Œå› ç‚ºä»–ç„¡æ³•æŒæ¡æ˜¯å“ªè£¡å‡ºéŒ¯äº†ï¼Œæ‰€ä»¥å»ºè­°å¤§å®¶åŸ¹é¤Šæ’°å¯«try-catchçš„å¥½ç¿’æ…£

å¦‚æœæœ‰æ™‚éº¼è§£é‡‹ä¸å¤ æ¸…æ¥šçš„æ­¡è¿åœ¨ä¸‹æ–¹ç•™è¨€è¨è«–å–”    

â„¹ï¸ å°ˆæ¡ˆåŸå§‹ç¢¼
----
* ä»Šå¤©çš„å®Œæ•´ç¨‹å¼ç¢¼å¯ä»¥åœ¨[é€™è£¡](https://github.com/dean9703111/ithelp_30days/day14)æ‰¾åˆ°å–”
* æˆ‘ä¹Ÿè²¼å¿ƒåœ°æŠŠæ˜¨å¤©çš„æŠŠæ˜¨å¤©çš„ç¨‹å¼ç¢¼æ‰“åŒ…æˆ[å£“ç¸®æª”](https://github.com/dean9703111/ithelp_30days/sampleCode/day13_sample_code.zip)ï¼Œä½ å¯ä»¥ç”¨è£¡é¢ä¹¾æ·¨çš„ç’°å¢ƒä¾†å¯¦ä½œä»Šå¤©try-catchçš„éƒ¨åˆ†å–”
    * è«‹è¨˜å¾—åœ¨çµ‚ç«¯æ©Ÿä¸‹æŒ‡ä»¤ **yarn** æ‰æœƒæŠŠä¹‹å‰çš„å¥—ä»¶å®‰è£
    * èª¿æ•´ä½ .envæª”å¡«ä¸ŠIGã€FBç™»å…¥è³‡è¨Š

### [Day15 å–„ç”¨jsonè®“ä½ æ‰¹é‡çˆ¬èŸ²](/day15/README.md)