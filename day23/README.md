#### [å›ç›®éŒ„](../README.md)
## Day23 Google Sheets-å„ªåŒ–æ ¼å¼ï¼Œæ»¿è¶³å®¢æˆ¶éœ€æ±‚ & è«‡ä½¿ç”¨è€…é«”é©—

>ä½ æ˜¯åšå¥½ä¸€ä»¶ä½œå“ï¼Œé‚„æ˜¯å®Œæˆä¸€é …ä»»å‹™

ğŸ† ä»Šæ—¥ç›®æ¨™
----
### 1. äº†è§£ä½¿ç”¨è€…é«”é©—ç‚ºä»€éº¼é‡è¦
1.1 é‚£äº›ä¸å ªå›é¦–çš„å…±åŒå›æ†¶
1.2 æ˜¯ä»€éº¼åŸå› è£½é€ å‡ºé€™äº›é«”é©—çš„
1.3 æœ‰åœ¨ä½¿ç”¨ç”¢å“çš„äººæ‰æœƒçµ¦ä½ æœ€çœŸå¯¦çš„å›é¥‹ï¼Œå°ˆæ¡ˆé‚„æœ‰å“ªäº›åœ°æ–¹è¦æ”¹å–„å‘¢ï¼Ÿ

### 2. å„ªåŒ–`ç”¨æ‰‹æ©Ÿä¾†çœ‹Google Sheetsçš„çˆ¬èŸ²è³‡æ–™`çš„é«”é©—
2.1 å¦‚ä½•å„ªåŒ–`ç”¨æ‰‹æ©Ÿä¾†çœ‹Google Sheetsçš„çˆ¬èŸ²è³‡æ–™`
2.2 çª—å£å‡çµï¼šå°‡æœ€ä¸Šæ–¹çš„çˆ¬èŸ²æ—¥æœŸã€å·¦æ–¹çš„ç²‰å°ˆåç¨±æ¬„ä½å‡çµ
2.3 æ¬„ä½å¯¬åº¦èª¿æ•´ï¼šæ¸›å°‘è¿½è¹¤äººæ•¸çš„æ¬„ä½å¯¬åº¦

----

# 1. äº†è§£ä½¿ç”¨è€…é«”é©—ç‚ºä»€éº¼é‡è¦
>è®“å®¢æˆ¶ç”¨çš„é–‹å¿ƒä»–å€‘æ‰æœƒè²·å–®

### 1.1 é‚£äº›ä¸å ªå›é¦–çš„å…±åŒå›æ†¶
æˆ‘æƒ³æ¯å€‹äººéƒ½æœ‰éé¡ä¼¼ç¶“é©—ï¼š
1. **æ“ä½œç³»çµ±æ™‚è®“ä½ æ„Ÿåˆ°ç„¦æ…®**
    * æˆ‘ï¼¸ï¼Œåˆ°åº•é€™å€‹ç³»çµ±è¦æ€éº¼æ“ä½œå•Šï¼Ÿç‚ºä»€éº¼æŒ‰ä¸‹å»æ²’åæ‡‰ï¼Ÿåˆ°åº•å“ªè£¡å¼„éŒ¯äº†ï¼Ÿ
    * å¡åœ¨loadingçš„ç•«é¢å·²ç¶“10åˆ†é˜ï¼Œæ‰€ä»¥æˆ‘è¦ç¹¼çºŒç­‰å—ï¼Ÿ
2. **ä½ æƒ³è¦ç”¨çš„åŠŸèƒ½æœƒéš±èº«è¡“**
    * æˆ‘æƒ³è¦ç”¨XXXåŠŸèƒ½ï¼Œåˆ°åº•ä»–åœ¨å“ªè£¡æ‰èƒ½æ“ä½œï¼Ÿ
    * ç‚ºä»€éº¼è¦æ”¹ç‰ˆå•¦ï¼ŸåŠŸèƒ½éƒ½ä¸çŸ¥é“è·‘å»å“ªäº†ï¼Ÿ
3. **æ¯å€‹æŒ‰éˆ•éƒ½åƒå®šæ™‚ç‚¸å½ˆ**
    * æ‰€ä»¥é€™å€‹æŒ‰éˆ•æ˜¯ä»€éº¼æ„æ€ï¼Ÿæ˜¯ä¸‹ä¸€æ­¥é‚„æ˜¯é€å‡ºï¼Ÿ
    * ç—¾...ä¸‹å–®äº†ï¼Ÿé€™ä¸æ˜¯åŠ å…¥è³¼ç‰©è»Šå—ï¼Ÿ
4. **æ‡·ç–‘è¨­è¨ˆè€…æ˜¯ä¸æ˜¯å—‘è—¥**
    * ç°¡è¨Šçš„é©—è­‰ç¢¼æœ‰6ç¢¼ï¼Œå¯æ˜¯çœ¼å‰èƒ½è¼¸å…¥çš„æ¬„ä½åªæœ‰4ç¢¼ï¼Œæ˜¯åœ¨å“ˆåš•ï¼Ÿ
    * ç·šä¸Šå¡«å®Œè¡¨æ ¼å¾Œä¸èƒ½å„²å­˜åªèƒ½ä¸‹è¼‰åˆ—å°å¾Œå¯„çµ¦ä¸»è¾¦å–®ä½ï¼Œå¦‚æœè¦ç”¨éƒµä»¶å¯„å‡ºå¹¹å˜›è¨­è¨ˆæˆç¶²é ?


### 1.2 æ˜¯ä»€éº¼åŸå› è£½é€ å‡ºé€™äº›é«”é©—çš„
ç›¸ä¿¡é‡åˆ°é€™äº›ç¶“é©—çš„æ™‚å€™å¤§å®¶å¿ƒè£¡éƒ½æœƒæƒ³ï¼š`é€™éº¼çˆ›çš„æ±è¥¿åˆ°åº•æ˜¯èª°è¨­è¨ˆå‡ºä¾†çš„å•Šï¼Ÿä»–è‡ªå·±çœŸçš„æœ‰ç”¨éå—ï¼Ÿ`

ç¸½çµç™¼ç”Ÿé€™äº›ä¸å¥½çš„ç¶“é©—é€šå¸¸éƒ½æ˜¯å› ç‚ºï¼š
1. **æ²’æœ‰äº†è§£ä½¿ç”¨è€…çœŸæ­£çš„éœ€æ±‚**ï¼šé€™æ˜¯è¨±å¤šå¤–åŒ…æ¡ˆçš„çœŸå¯¦ç‹€æ³ï¼Œå·¥ç¨‹å¸«çš„ç›®æ¨™æ˜¯é©—æ”¶é€šéï¼Œè€Œæ‰¿åŒ…å•†ä¹Ÿåªæ˜¯ç‚ºäº†æŠŠäº‹æƒ…åšå®Œæœ‰ç¸¾æ•ˆï¼Œç•¶`ç”²ä¹™æ–¹éƒ½ä¸åœ¨ä¹çµ‚ç«¯ä½¿ç”¨è€…çš„éœ€æ±‚æ™‚ï¼Œå®Œæˆçš„ç”¢å“é€šå¸¸ä¸å ªå…¥ç›®`
2. **ç¶“é©—ä¸è¶³**ï¼šå¾ˆå¤šæ™‚å€™æœ‰äº›å ±åƒ¹æ¯”è¼ƒä½çš„æ¡ˆå­æœƒäº¤çµ¦å…¬å¸çš„æ–°äººï¼Œå¦‚æœå…¬å¸ä¹Ÿæ²’æœ‰è®“å‰è¼©åœ¨æ—é‚Šçµ¦äºˆæŒ‡å°æœƒè®“é€™å€‹`ç”¢å“æœ‰éå¸¸å¤šçš„æ¼æ´`
3. **æ²’æœ‰è¶³å¤ çš„æ¸¬è©¦**ï¼šæœ‰äº›æ¡ˆå­æ™‚ç¨‹éå¸¸çš„è¶•ï¼Œåœ¨é€™æ¨£çš„ç‹€æ…‹ä¸‹é€šå¸¸`ç”¢å“çš„ç©©å®šåº¦å¾ˆä½ï¼Œä¸”æ“ä½œæ™‚ä¹Ÿå¾ˆå®¹æ˜“ç™¼ç”ŸéŒ¯èª¤`
4. **ç¶“è²»ä¸è¶³**ï¼šèŠ±å¤§éŒ¢çš„æ¡ˆå­ä¸ä¸€å®šåšå¾—å¥½ï¼Œä½†æ˜¯éŒ¢å°‘çš„æ¡ˆå­åŸºæœ¬ä¸Šéƒ½ä¸å¤ªå¥½ï¼Œä¸€åˆ†éŒ¢ä¸€åˆ†è²¨ï¼Œ`å£“åƒ¹æ ¼çš„æ™‚å€™ä¸€å®šæœƒå–ªå¤±å“è³ª`

### 1.3 æœ‰åœ¨ä½¿ç”¨ç”¢å“çš„äººæ‰æœƒçµ¦ä½ æœ€çœŸå¯¦çš„å›é¥‹ï¼Œå°ˆæ¡ˆé‚„æœ‰å“ªäº›åœ°æ–¹è¦æ”¹å–„å‘¢ï¼Ÿ
æ²’æœ‰ä¸€é–‹å§‹å°±å®Œç¾çš„å°ˆæ¡ˆï¼Œ`å®¢æˆ¶çš„éœ€æ±‚æœƒåœ¨ä½¿ç”¨çš„éç¨‹ä¸­æ…¢æ…¢å¢åŠ `ï¼Œé€™å€‹å°ˆæ¡ˆä¹Ÿåœ¨æ¥­ä¸»ä½¿ç”¨çš„éç¨‹ä¸­å¢åŠ äº†ä¸€äº›éœ€æ±‚ï¼š
1. ä¸‹ç­å¾Œæœƒ`ç”¨æ‰‹æ©Ÿä¾†çœ‹Google Sheetsçš„çˆ¬èŸ²è³‡æ–™`ï¼Œæ“ä½œèµ·ä¾†ä¸æ˜¯å¾ˆé †ï¼Œæƒ³å•æœ‰æ²’æœ‰å¥½çš„å»ºè­°
2. ä¸Šç­å¤ªå¿™æœƒå¿˜è¨˜è·‘çˆ¬èŸ²ç¨‹å¼ï¼Œèƒ½ä¸èƒ½`æŒ‡å®šçˆ¬èŸ²ç¨‹å¼åœ¨æŸå€‹æ™‚é–“é»è‡ªå‹•åŸ·è¡Œ`
3. å› ç‚ºåŸ·è¡Œçˆ¬èŸ²ç¨‹å¼çš„æ™‚å€™æˆ‘ä¹Ÿè¦åšäº‹æƒ…ï¼Œèƒ½ä¸èƒ½`æœ‰å€‹é€šçŸ¥æé†’æˆ‘çˆ¬èŸ²åŸ·è¡Œçš„ç‹€æ³`

ä»Šå¤©æœƒå…ˆè¬› **ç¬¬ä¸€é»** çš„å„ªåŒ–æ–¹æ¡ˆï¼Œè®“æˆ‘å€‘ä¸€èµ·å°‡é€™å€‹å°ˆæ¡ˆè®Šå¾—æ›´å¥½ç”¨å§ï¼

----

# 2. å„ªåŒ–`ç”¨æ‰‹æ©Ÿä¾†çœ‹Google Sheetsçš„çˆ¬èŸ²è³‡æ–™`çš„é«”é©—
>åŸå‰‡ä¸Šä½ æƒ³å°Google Sheetsçš„ä»»ä½•æ“ä½œå®˜æ–¹éƒ½æœ‰æä¾›apiçµ¦ä½ ï¼Œå¦‚æœä½ æ™‚å¸¸æœƒä½¿ç”¨åˆ°çš„è©±è«‹ä¸€å®šè¦è®€æ‡‚å®˜æ–¹æ–‡ä»¶ï¼Œé—œæ–¼å®˜æ–¹æ–‡ä»¶çš„é–±è®€å¯ä»¥è¤‡ç¿’[é€™ç¯‡æ–‡ç« ](/day19/README.md)å–”

### 2.1 å¦‚ä½•å„ªåŒ–`ç”¨æ‰‹æ©Ÿä¾†çœ‹Google Sheetsçš„çˆ¬èŸ²è³‡æ–™`
é€™å€‹å•é¡Œåˆ†æèµ·ä¾†å¾ˆç°¡å–®ï¼Œä¸»è¦å°±æ˜¯ä¸‹é¢å…©é»ï¼š
1. å› ç‚ºè³‡æ–™å­˜åœ¨Google sheetsä¸Šé¢ï¼Œè³‡æ–™é‡ä¸€å¤§å°±å¾ˆé›£è§€çœ‹
2. æ‰‹æ©Ÿè¢å¹•å°ï¼Œèƒ½å‘ˆç¾çš„è³‡æ–™ä¸å¤š

å¾Œä¾†å†è·Ÿå®¢æˆ¶è¨è«–çš„éç¨‹ä¸­ç™¼ç¾`é€™å€‹å•é¡Œåœ¨ä½¿ç”¨é›»è…¦æ™‚ä¹Ÿæœƒæœ‰ï¼Œä½†æ˜¯ä½¿ç”¨æ‰‹æ©Ÿæ™‚å•é¡Œæ›´åš´é‡`ï¼Œæ–¼æ˜¯æˆ‘å†çœ‹ä»–Google Sheetsçš„çˆ¬èŸ²è³‡æ–™æ™‚æå‡ºäº†å„ªåŒ–æ–¹æ¡ˆï¼Œè®“ä»–åœ¨ä½¿ç”¨ä¸Šæ–¹ä¾¿è¨±å¤šï¼š
1. **å°‡æœ€ä¸Šæ–¹çš„çˆ¬èŸ²æ—¥æœŸã€å·¦æ–¹çš„ç²‰å°ˆåç¨±æ¬„ä½å‡çµ**
  * é€™æ¨£åœ¨ç€è¦½æ™‚å°±ä¸éœ€è¦ä¸€ç›´å¾€ä¸Šç¢ºèªæ—¥æœŸã€å¾€å·¦ç¢ºèªä»–æ˜¯å“ªå€‹ç²‰å°ˆäº†
2. **æ¸›å°‘è¿½è¹¤äººæ•¸çš„æ¬„ä½å¯¬åº¦**
  * æˆ‘å€‘ç„¡æ³•æ”¹è®Šæ‰‹æ©Ÿçš„è¢å¹•å¯¬åº¦ï¼Œä½†æ˜¯æ”¹è®Šè³‡æ–™æ¬„ä½çš„å¯¬åº¦èƒ½è®“ä¸€å€‹è¢å¹•èƒ½å‘ˆç¾æ›´å¤šçš„è³‡è¨Š


### 2.2 çª—å£å‡çµï¼šå°‡æœ€ä¸Šæ–¹çš„çˆ¬èŸ²æ—¥æœŸã€å·¦æ–¹çš„ç²‰å°ˆåç¨±æ¬„ä½å‡çµ
æˆ‘å°‡é€™å€‹åŠŸèƒ½åˆä½µåˆ°å‰µå»ºsheetçš„å‡½å¼`addSheet`ï¼Œçª—å£å‡çµé€™ä»¶äº‹åœ¨`å»ºç«‹sheetæ™‚åŸ·è¡Œä¸€æ¬¡å°±å¤ äº†`
>è©³ç´°çš„å®˜æ–¹æ–‡ä»¶è«‹åƒè€ƒ[çª—å£å‡çµ](https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets#gridproperties)
```js
async function addSheet (title, sheet_id, auth) {
  const sheets = google.sheets({ version: 'v4', auth });
  const request = {
    "spreadsheetId": process.env.SPREADSHEET_ID,
    "resource": {
      "requests": [{
        "addSheet": {
          "properties": {
            "title": title,
            "gridProperties": {
              "frozenRowCount": 1,//æœ€ä¸Šé¢é‚£ä¸€åˆ—(çˆ¬èŸ²æ—¥æœŸ)è¨­å®šç‚ºå‡çµ
              "frozenColumnCount": 1//æœ€å·¦é‚Šé‚£ä¸€æ¬„(ç²‰å°ˆåç¨±)è¨­å®šç‚ºå‡çµ
            },
          }
        },
      }]
    }
  };
  try {
    await sheets.spreadsheets.batchUpdate(request)
    console.log('added sheet:' + title)
  }
  catch (err) {
    console.log('The API returned an error: ' + err);
  }
}
```

### 2.3 æ¬„ä½å¯¬åº¦èª¿æ•´ï¼šæ¸›å°‘è¿½è¹¤äººæ•¸çš„æ¬„ä½å¯¬åº¦
ç‚ºäº†èƒ½å®¹ç´èƒ½å¤šçš„è³‡è¨Šé‡ï¼Œæ‰€ä»¥æˆ‘å€‘è¦åœ¨åœ¨æ’å…¥æ–°æ¬„ä½`insertEmptyCol`æ™‚çµ¦ä»–ä¸€å€‹åˆé©çš„æ¬„ä½å¯¬åº¦
* åœ¨ä¸‹æ–¹ç¯„ä¾‹ç¨‹å¼ä¸­ä½ å¯ä»¥ç™¼ç¾ Google Sheets çš„ `requests å…§æ˜¯å¯ä»¥åŸ·è¡Œå¤šå€‹è¦æ±‚çš„(insertDimensionã€updateDimensionProperties)`
>è©³ç´°çš„å®˜æ–¹æ–‡ä»¶è«‹åƒè€ƒ[æ¬„ä½å¯¬åº¦èª¿æ•´](https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#UpdateDimensionPropertiesRequest)  
```js
async function insertEmptyCol (title, sheet_id, auth) {
  const sheets = google.sheets({ version: 'v4', auth });
  const request = {
    "spreadsheetId": process.env.SPREADSHEET_ID,
    "resource": {
      "requests": [{
        "insertDimension": {
          "range": {
            "sheetId": sheet_id,
            "dimension": "COLUMNS",
            "startIndex": 1,
            "endIndex": 2
          },
          "inheritFromBefore": true
        }
      },
      {
        "updateDimensionProperties": {//é€™è£¡æ˜¯ç‚ºäº†ä¿®æ­£æ¬„å¯¬
          "range": {
            "sheetId": sheet_id,
            "dimension": "COLUMNS",
            "startIndex": 1,//åªéœ€è¦é¦–æ¬„
            "endIndex": 2
          },
          "properties": {
            "pixelSize": 85//æ¬„ä½å¯¬åº¦
          },
          "fields": "pixelSize"
        }
      }]
    }
  };
  try {
    await sheets.spreadsheets.batchUpdate(request)
    console.log('update sheet:' + title + ' new column')
  }
  catch (err) {
    console.log('The API returned an error: ' + err);
  }
}
```

----

åŸ·è¡Œç¨‹å¼
----
1. åœ¨åŸ·è¡Œç¨‹å¼ä¹‹å‰è«‹å…ˆæŠŠGoogle Sheetsçš„'FBç²‰å°ˆ'ã€'IGå¸³è™Ÿ'é€™å…©å€‹sheetåˆªé™¤ï¼Œå› ç‚º`addSheetå‡½å¼è¦è§¸ç™¼æ‰æœƒæœ‰çª—å£å‡çµ`çš„åŠŸèƒ½  
2. åˆªé™¤sheetå¾Œ åœ¨å°ˆæ¡ˆè³‡æ–™å¤¾çš„çµ‚ç«¯æ©Ÿ(Terminal)åŸ·è¡ŒæŒ‡ä»¤
```vim
yarn start
```
3. çœ‹çœ‹ç·šä¸Šçš„Google Sheetsæ˜¯å¦æœ‰ç¬¦åˆä»Šå¤©è¨­å®šçš„æ ¼å¼ï¼šçª—å£å‡çµã€æ¬„ä½å¯¬åº¦èª¿æ•´
![image](./article_img/terminal.png)  
![image](./article_img/googlesheet.png)  

----

â­ï¸ ä¸‹å€‹éšæ®µ
------------------------
Google Sheetsç³»åˆ—æ–‡ç« åˆ°é€™è£¡å‘Šä¸€å€‹æ®µè½ï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘ä¾ç…§ä»Šå¤©æåˆ°å°ˆæ¡ˆè¦æ”¹å–„çš„åœ°æ–¹ç¹¼çºŒå‰é€²ï¼Œæ¥è‘—ä¾†èŠèŠ`æŠŠæ’ç¨‹åŠ å…¥çˆ¬èŸ²å°ˆæ¡ˆ`é€™å€‹ä¸»é¡Œå§

----

â„¹ï¸ å°ˆæ¡ˆåŸå§‹ç¢¼
----
* ä»Šå¤©çš„å®Œæ•´ç¨‹å¼ç¢¼å¯ä»¥åœ¨[é€™è£¡](https://github.com/dean9703111/ithelp_30days/tree/master/day23)æ‰¾åˆ°å–”
* æˆ‘ä¹Ÿè²¼å¿ƒåœ°æŠŠæ˜¨å¤©çš„æŠŠæ˜¨å¤©çš„ç¨‹å¼ç¢¼æ‰“åŒ…æˆ[å£“ç¸®æª”](https://github.com/dean9703111/ithelp_30days/raw/master/sampleCode/day22_sample_code.zip)ï¼Œä½ å¯ä»¥ç”¨è£¡é¢ä¹¾æ·¨çš„ç’°å¢ƒä¾†å®Œæˆæ¥­ä¸»è¦æ±‚çš„éœ€æ±‚è®Šæ›´å§
    * è«‹è¨˜å¾—åœ¨çµ‚ç«¯æ©Ÿä¸‹æŒ‡ä»¤ **yarn** æ‰æœƒæŠŠä¹‹å‰çš„å¥—ä»¶å®‰è£
    * è¦åœ¨tools/google_sheetsè³‡æ–™å¤¾æ”¾ä¸Šè‡ªå·±çš„æ†‘è­‰
    * èª¿æ•´fanspagesè³‡æ–™å¤¾å…§ç›®æ¨™çˆ¬èŸ²çš„ç²‰å°ˆç¶²å€
    * èª¿æ•´.envæª”
        * å¡«ä¸ŠFBç™»å…¥è³‡è¨Š
        * å¡«ä¸ŠFBç‰ˆæœ¬(classic/new)
        * å¡«ä¸ŠIGç™»å…¥è³‡è¨Š
        * å¡«ä¸ŠSPREADSHEET_ID

ğŸ“– åƒè€ƒè³‡æº
----
1. [äº†è§£ä½¿ç”¨è€…é«”é©— (UX) çš„ç¬¬ä¸€å ‚èª²](https://designtongue.me/%E4%BA%86%E8%A7%A3%E4%BD%BF%E7%94%A8%E8%80%85%E9%AB%94%E9%A9%97-ux-%E7%9A%84%E7%AC%AC%E4%B8%80%E5%A0%82%E8%AA%B2/)
### [Day24 æ’ç¨‹-Cronå¥—ä»¶è¶…è©³è§£ï¼Œè®“çˆ¬èŸ²è‡ªå·±å‹•èµ·ä¾†](/day24/README.md)