#### [å›ç›®éŒ„](../README.md)
## Day8 selenium-webdriverï¼šçˆ¬èŸ²èµ·æ‰‹å¼ï¼Œå¸¶ä½ èªè­˜æ‰€è¦‹å³æ‰€å¾—çš„çˆ¬èŸ²å·¥å…·

ğŸ¤” ç‚ºä»€éº¼é¸çˆ¬èŸ²ä½œç‚ºä¸»é¡Œ?
----
åœ¨æ±ºå®šä»¥çˆ¬èŸ²ä½œç‚ºä¸»é¡Œæ™‚æœ‰æœ‹å‹å‹¸æˆ‘ä¸è¦å¯«é€™é¡æœ‰çˆ­è­°çš„ä¸»é¡Œï¼Œä½†å› ç‚ºä»¥ä¸‹å¹¾é»æˆ‘é‚„æ˜¯é¸äº†é€™å€‹ä¸»é¡Œï¼š
1. **çˆ¬èŸ²é“å¾·è§€**ï¼šæœ‰äº›ç¶²è·¯æ–‡ç« é“å¾·è§€å´©å£ï¼ŒæŠŠä¸€å€‹å¥½çš„æŠ€è¡“è®Šæˆæ™ºæ…§è²¡ç”¢çš„ç›œè³Š
2. **ä¸­æ–‡è³‡æºç¼ºä¹ï¼ŒæŠ€è¡“éæ™‚**ï¼šä¸­æ–‡çš„æ•™å­¸æ–‡ç« è¼ƒå°‘ï¼Œè¨±å¤šç¯„ä¾‹çš„æŠ€è¡“åˆ°ä»Šå¤©å·²ç¶“ç„¡æ³•ä½¿ç”¨äº†
3. **ç¼ºä¹ç³»çµ±æ€§çš„æ•´åˆ**ï¼šç¶²è·¯ä¸Šçš„è³‡æºç›¸å°é›¶ç¢ï¼Œå­¸ç¿’ä¸Šç¼ºä¹ç³»çµ±æ€§ï¼Œå®¹æ˜“åœ¨å­¸ç¿’éç¨‹ä¸­é‡åˆ°å•é¡Œè€ŒåŠé€”è€Œå»¢

ğŸ¤” å­¸ç¿’çˆ¬èŸ²å°æˆ‘æœ‰ä»€éº¼å¥½è™•?
----
* **å¦‚æœä½ æ˜¯å·¥ç¨‹å¸«**
    1. æœ€ç›´æ¥çš„å¥½è™•å°±æ˜¯è®“ä½ åœ¨`æœªä¾†è·æ¶¯ä¸Šæœ‰æ›´å¤šçš„é¸æ“‡`
    2. å¯ä»¥å¤§é‡`è¨“ç·´ä½ å°ç¶²é æ¶æ§‹çš„èªçŸ¥`
    3. ç•¶ä½ å­¸æœƒçˆ¬èŸ²æ™‚ï¼Œä½ å°±èƒ½å¯«å‡ºç›¸å°ä¾†èªª`åçˆ¬èŸ²çš„ç¶²é `äº†
* **å¦‚æœä½ æ˜¯è¡ŒéŠ·å»£å‘Šã€é›»å•†å°ç·¨**
    1. ä½ å¯ä»¥é€éçˆ¬èŸ²ä¾†`äº†è§£ç¶²è·¯ä¸–ç•Œåœ¨è³‡æ–™é€™å¡Šçš„é‚è¼¯`
    2. å°±ç®—ä½ çœ‹å®Œæ–‡ç« å¾Œé‚„æ˜¯ç„¡æ³•å®Œå…¨æŒæ¡ï¼Œä½†ç•¶ä½ è«‹å·¥ç¨‹å¸«ä¾†æ’°å¯«çˆ¬èŸ²æ™‚ï¼Œä½ èƒ½å¾ˆå…·é«”åœ°`èªªå‡ºä½ çš„éœ€æ±‚ä¸¦èˆ‡å·¥ç¨‹å¸«æºé€šé †æš¢`
    3. æˆ‘èªç‚ºæŒæ¡`åˆ†æè³‡æ–™èƒ½åŠ›`çš„äººæ‰æœ€æœ‰æ©Ÿæœƒåšå‡ºèƒ½èªªæœå…¬å¸çš„ç­–ç•¥


ğŸ† ä»Šæ—¥ç›®æ¨™
----
1. çŸ¥é“å¦‚ä½•é¸æ“‡é©åˆçš„çˆ¬èŸ²å·¥å…·
2. ä½¿ç”¨selenium-webdriveré–‹å•Ÿç€è¦½å™¨
3. è§£æ±ºwindowsç„¡æ³•è‡ªå‹•è®€å–chromedriver.exeè·¯å¾‘çš„å•é¡Œ
    * å¯«åˆ¤æ–·Driveræ˜¯å¦è¨­å®šçš„å‡½å¼

ğŸ¤” å¦‚ä½•é¸æ“‡é©åˆçš„çˆ¬èŸ²å·¥å…·?
----
åœ¨[Day5](/day5/README.md)æˆ‘å€‘æœ‰æåˆ°å°‹æ‰¾å·¥å…·çš„æ–¹æ³•ï¼Œç¾åœ¨æˆ‘å€‘ä¾åºçš„ä¾†èªªæ˜:
1. å®˜æ–¹è³‡æº
    * ç”±æ–¼è¿‘å¹´ FB & IG çš„apiæ”¹ç‰ˆé »ç¹ï¼ŒåŠ ä¸Šå„å¼å„æ¨£æ¬Šé™çš„é™åˆ¶å°è‡´æˆ‘å€‘é€£å…¬é–‹è³‡æ–™éƒ½ç„¡æ³•å¾—åˆ°ï¼Œæ‰€ä»¥åœ¨é€™è£¡æˆ‘å€‘æ”¾æ£„ä½¿ç”¨å®˜æ–¹æä¾›çš„api  
2. ç¶²è·¯è³‡æº
    * é€éä¸‹é—œéµå­—æˆ‘å€‘å¯ä»¥çœ‹åˆ°å¾ˆå¤šäººåˆ†äº«ç›¸é—œçˆ¬èŸ²çš„ç¶“é©—ï¼Œæˆ‘å€‘å¯ä»¥å…ˆæŠŠé€™äº›ç¯„ä¾‹ç”¨åˆ°çš„å¥—ä»¶è¨˜éŒ„ä¸‹ä¾†
3. æŸ¥è©¢npmå¥—ä»¶
    * æˆ‘å€‘å·²ç¶“é€éç¶²è·¯è³‡æºæœç´¢åˆ°å¾ˆå¤šçœ‹èµ·ä¾†èƒ½ä½¿ç”¨çš„å¥—ä»¶ï¼Œä½†èƒ½å¦æ‡‰ç”¨åœ¨æˆ‘å€‘çš„å¯¦éš›éœ€æ±‚å°±éœ€è¦è¿‘ä¸€æ­¥é€éå¯¦éš›æ¸¬è©¦ä¾†ç¢ºèªï¼Œä»¥ä¸‹æ˜¯æˆ‘ç•¶æ™‚æ‰¾åˆ°çš„è³‡æºä¸¦é™„ä¸Šæ™‚æ¸¬å¾Œçš„åˆ†æ:
        1. request & cheerio
            * ä¸‹é—œéµå­—å€™ç¬¬ä¸€å€‹æ‰¾åˆ°çš„è³‡æºï¼Œä½¿ç”¨ç¯„ä¾‹ç¨‹å¼æ¸¬è©¦å¾Œç¢ºèªä»–å¯ä»¥é€éç¶²å€æŠ“åˆ°ç¶²é å…ƒç´ ä¸¦é€²è¡Œåˆ†æ
            * but...ä»–åœ¨ FBã€IG é¢å‰æ¯«ç„¡ç”¨æ­¦ä¹‹åœ°ï¼Œå› ç‚ºFBæœƒåµæ¸¬ä½ ä½¿ç”¨çš„ç€è¦½å™¨ï¼Œæ‰€ä»¥åœ¨ç¬¬ä¸€é—œä»–å°±é™£äº¡äº†
        2. selenium-webdriver
            * åŸºæœ¬ä¸Šä»–æ˜¯ä¸€å€‹ç„¡è«–æ˜¯ä»€éº¼ç¶²é éƒ½èƒ½å¤ çˆ¬èŸ²çš„å·¥å…·äº†ï¼Œæˆ‘èªç‚ºéå¸¸é©åˆæ–°æ‰‹ä½¿ç”¨
            * å·¥å…·åŸ·è¡Œæ™‚æœƒé–‹å•Ÿä¸€å€‹ç¶²é ï¼Œç„¶å¾Œæ¨¡æ“¬äººé¡çœŸå¯¦çš„æ“ä½œæ¯å€‹æ­¥é©Ÿï¼Œæ‰€ä»¥æ•ˆç‡ç›¸å°å·®
            * æ‰€è¦‹å³æ‰€å¾—ï¼Œçœ‹å¾—åˆ°çš„è³‡è¨Šéƒ½èƒ½å¤ æŠ“ä¸‹ä¾†ï¼Œå­¸ç¿’èµ·ä¾†éå¸¸å®¹æ˜“ä¸”ç›´è¦ºï¼Œæ‰€ä»¥é€™æ˜¯`æœ¬å°ˆæ¡ˆæœ€å¾Œé¸æ“‡çš„å·¥å…·`
        3. Puppeteer(é‚¦å‹è£œå……)
            * æ“ä½œé‚è¼¯èˆ‡ selenium-webdriver éå¸¸é¡ä¼¼
            * é è¨­é™„å¸¶ Chronium ç€è¦½å™¨ï¼Œä¸æœƒæœ‰ç€è¦½å™¨åŒ¹é…å•é¡Œ(ä½†æ˜¯åªèƒ½ç”¨é€™å€‹ç€è¦½å™¨QQ)
            * åªèƒ½ä½¿ç”¨ Node.js æ’°å¯«ï¼Œä¸åƒ selenium-webdriver æœ‰å¤šç¨®èªè¨€çš„ binding


ğŸ”§ ä½¿ç”¨selenium-webdriveré–‹å•Ÿç€è¦½å™¨
----
æˆ‘çš„æ–‡ç« æœƒæœƒä¾æ“šéœ€æ±‚ä½¿ç”¨åˆ°å®ƒçš„å„ç¨®åŠŸèƒ½ï¼Œå¦‚æœæœ‰è¿«ä¸åŠå¾…çš„å°å¤¥ä¼´ä¹Ÿå¯ä»¥å…ˆå»[å®˜ç¶²](https://www.selenium.dev/documentation/en/)ä¾†æ›´æ·±åˆ»çš„äº†è§£ä»–  

1. å‰ç½®ç’°å¢ƒå®‰è£
    * å…ˆåœ¨çµ‚ç«¯æ©Ÿ(Terminal)ä¸‹æŒ‡ä»¤å®‰è£ä»–  
        ```
        yarn add selenium-webdriver
        ```
    * æœ¬å°ˆæ¡ˆä½¿ç”¨çš„æ¨¡æ“¬å™¨æ˜¯chromeï¼Œé›»è…¦é‚„æ²’è£çš„è«‹å…ˆ[ä¸‹è¼‰](https://www.google.com/intl/zh-TW/chrome/)
    * å› ç‚ºè·‘seleniuméœ€è¦ç”¨åˆ°driverï¼Œå¤§å®¶å¯ä»¥ä¾ç…§è‡ªå·±çš„ä½œæ¥­ç³»çµ±åšè¨­å®š
        + **mac ä½œæ¥­ç³»çµ±**  
            * å¦‚æœä½ ç”¨çš„é›»è…¦æ˜¯macï¼Œæ­å–œä½ ï¼Œä¸è¦éœ€è¦é¡å¤–ä¸‹è¼‰chrome driverå°±èƒ½å¤ ç›´æ¥å¯«ä½¿ç”¨(ä¸échromeé‚„æ˜¯è¦ä¸‹è¼‰)  
        + **windows ä½œæ¥­ç³»çµ±**
            1. **å…ˆç¢ºèªè‡ªå·±chromeç‰ˆæœ¬**ï¼šå°‡`chrome://settings/help`è²¼åˆ°ä½ çš„ç¶²å€åˆ—
                ![image](./article_img/chrome_info.png)
            2. ä¸‹è¼‰`èˆ‡ä½ chromeç‰ˆæœ¬ç›¸åŒ`çš„[chrome driver](http://chromedriver.storage.googleapis.com/index.html)  
                ![image](./article_img/download_list.png)
                ![image](./article_img/download_detail.png)
            * ä¸‹è¼‰çš„å£“ç¸®æª”è§£å£“ç¸®å¾ŒæŠŠ`chromedriver.exeæ”¾åˆ°å°ˆæ¡ˆæ ¹ç›®éŒ„ä¸‹`

2. å˜—è©¦ç”¨selenium-webdriveræ‰“é–‹çˆ¬èŸ²ç”¨ç¶²é 
    #### index.js
    ```js
    require('dotenv').config(); //è¼‰å…¥.envç’°å¢ƒæª”
    const webdriver = require('selenium-webdriver') // åŠ å…¥è™›æ“¬ç¶²é å¥—ä»¶

    function openCrawlerWeb() {
        
        // å»ºç«‹é€™å€‹broswerçš„é¡å‹
        let driver = new webdriver.Builder().forBrowser("chrome").build();
        const web = 'https://www.google.com/';//å¡«å¯«ä½ æƒ³è¦å‰å¾€çš„ç¶²ç«™
        driver.get(web)//é€åœ‹é€™å€‹driveræ‰“é–‹ç¶²é 
    }
    openCrawlerWeb()//æ‰“é–‹çˆ¬èŸ²ç¶²é 
    ```

ğŸš€ åŸ·è¡Œç¨‹å¼
----
åœ¨å°ˆæ¡ˆè³‡æ–™å¤¾çš„çµ‚ç«¯æ©Ÿ(Terminal)åŸ·è¡ŒæŒ‡ä»¤
```vim
yarn start
```
å¦‚æœåŸ·è¡Œé †åˆ©ï¼Œä½ æœƒçœ‹åˆ°chromeçš„æ‡‰ç”¨ç¨‹å¼è‡ªå‹•æ‰“é–‹ä¸¦ä¸”é€²å…¥googleçš„é¦–é   
![image](./article_img/chrome.png)


ğŸ˜­ è§£æ±ºwindowsç„¡æ³•è‡ªå‹•è®€å–chromedriver.exeè·¯å¾‘
----
å› ç‚ºæœ‰äººå›å ±éƒ¨åˆ†windowså°±ç®—æŠŠchromedriver.exeæ”¾åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„ä¹Ÿè®€ä¸åˆ°ï¼Œæ‰€ä»¥ç‰¹åˆ¥å¯«äº†ä¸€å€‹ **checkDriver** çš„å‡½å¼ï¼Œé‚è¼¯å¦‚ä¸‹ï¼š
* åˆ¤æ–·æ˜¯å¦æœ‰é è¨­çš„chromedriver
    * Yes &rarr; ç„¡é ˆè¨­å®š
    * No &rarr; ç¢ºèªè·¯å¾‘ä¸‹æ˜¯å¦æœ‰ **chromedriver.exe** çš„æª”æ¡ˆ
        * Yes  &rarr; è¨­å®šdriverè·¯å¾‘
        * No &rarr; ç„¡æ³•è¨­å®šdriverè·¯å¾‘å›å‚³false

* å‚™è¨»
    * try-catché¡§åæ€ç¾©å°±æ˜¯å…ˆtryï¼Œå¦‚æœç™¼ç”Ÿå•é¡Œå°±æœƒcatchä¸¦åŸ·è¡ŒéŒ¯èª¤è™•ç†
    * **__dirname** é€™å€‹è®Šæ•¸ç‚ºç›®å‰æª”æ¡ˆæ‰€åœ¨çš„è³‡æ–™å¤¾è·¯å¾‘  
```js
const chrome = require('selenium-webdriver/chrome');
const path = require('path');//ç”¨æ–¼è™•ç†æ–‡ä»¶è·¯å¾‘çš„å°å·¥å…·
const fs = require("fs");//è®€å–æª”æ¡ˆç”¨

function checkDriver() {
    try {
        chrome.getDefaultService()//ç¢ºèªæ˜¯å¦æœ‰é è¨­
    } catch {
        console.log('æ‰¾ä¸åˆ°é è¨­driver!');
        const file_path = '../chromedriver.exe'//'../chromedriver.exe'è¨˜å¾—èª¿æ•´æˆè‡ªå·±çš„è·¯å¾‘
        console.log(path.join(__dirname, file_path));//è«‹ç¢ºèªå°å‡ºä¾†æ—¥èªŒä¸­çš„ä½ç½®æ˜¯å¦èˆ‡ä½ è·¯å¾‘ç›¸åŒ
        if (fs.existsSync(path.join(__dirname, file_path))) {//ç¢ºèªè·¯å¾‘ä¸‹chromedriver.exeæ˜¯å¦å­˜åœ¨            
            const service = new chrome.ServiceBuilder(path.join(__dirname, file_path)).build();//è¨­å®šdriverè·¯å¾‘
            chrome.setDefaultService(service);
            console.log('è¨­å®šdriverè·¯å¾‘');
        } else {
            console.log('ç„¡æ³•è¨­å®šdriverè·¯å¾‘');
            return false
        }
    }
    return true
}
```

* å°‡chromedriver.exeæ”¾åˆ°æ ¹ç›®éŒ„å¾Œè¨˜å¾—åœ¨.gitignoreæŠŠå®ƒåŠ é€²å»å¿½ç•¥æ¸…å–®å–”ï¼Œä»–ä¸å±¬æ–¼éœ€è¦ç‰ˆæ§çš„æª”æ¡ˆ
    #### .gitignore
    ```
    node_modules
    .env
    chromedriver.exe
    ```

ğŸ”€ èˆ‡åŸç¨‹å¼çµ±æ•´
----
åŠ å…¥ **checkDriver** å‡½å¼ä¾†æª¢æŸ¥Driveræ˜¯å¦æ˜¯è¨­å®šæ˜¯æ¯”è¼ƒå®Œæ•´çš„ç¨‹å¼è¦åŠƒï¼Œå› ç‚ºä»–èƒ½æ˜ç¢ºçš„å‘Šè¨´ä½ åŸ·è¡ŒéŒ¯èª¤çš„ä½ç½®ï¼Œä¹‹å¾Œæœƒæœ‰æ–‡ç« ä¾†è¨è«–try-catchçš„é‡è¦æ€§ï¼Œçµ±æ•´å¾Œç¨‹å¼å¦‚ä¸‹
#### index.js
```js
require('dotenv').config(); //è¼‰å…¥.envç’°å¢ƒæª”
const webdriver = require('selenium-webdriver') // åŠ å…¥è™›æ“¬ç¶²é å¥—ä»¶
const chrome = require('selenium-webdriver/chrome');
const path = require('path');//ç”¨æ–¼è™•ç†æ–‡ä»¶è·¯å¾‘çš„å°å·¥å…·
const fs = require("fs");//è®€å–æª”æ¡ˆç”¨

function checkDriver() {
    try {
        chrome.getDefaultService()//ç¢ºèªæ˜¯å¦æœ‰é è¨­
    } catch {
        console.log('æ‰¾ä¸åˆ°é è¨­driver!');
        const file_path = '../chromedriver.exe'//'../chromedriver.exe'è¨˜å¾—èª¿æ•´æˆè‡ªå·±çš„è·¯å¾‘
        console.log(path.join(__dirname, file_path));//è«‹ç¢ºèªå°å‡ºä¾†æ—¥èªŒä¸­çš„ä½ç½®æ˜¯å¦èˆ‡ä½ è·¯å¾‘ç›¸åŒ
        if (fs.existsSync(path.join(__dirname, file_path))) {//ç¢ºèªè·¯å¾‘ä¸‹chromedriver.exeæ˜¯å¦å­˜åœ¨            
            const service = new chrome.ServiceBuilder(path.join(__dirname, file_path)).build();//è¨­å®šdriverè·¯å¾‘
            chrome.setDefaultService(service);
            console.log('è¨­å®šdriverè·¯å¾‘');
        } else {
            console.log('ç„¡æ³•è¨­å®šdriverè·¯å¾‘');
            return false
        }
    }
    return true
}

function openCrawlerWeb() {

    if (!checkDriver()) {// æª¢æŸ¥Driveræ˜¯å¦æ˜¯è¨­å®šï¼Œå¦‚æœç„¡æ³•è¨­å®šå°±çµæŸç¨‹å¼
        return
    }
    
    // å»ºç«‹é€™å€‹broswerçš„é¡å‹
    let driver = new webdriver.Builder().forBrowser("chrome").build();
    const web = 'https://www.google.com/';//å¡«å¯«ä½ æƒ³è¦å‰å¾€çš„ç¶²ç«™
    driver.get(web)//é€åœ‹é€™å€‹driveræ‰“é–‹ç¶²é 
}
openCrawlerWeb()//æ‰“é–‹çˆ¬èŸ²ç¶²é 
```

â„¹ï¸ å°ˆæ¡ˆåŸå§‹ç¢¼
----
* ä»Šå¤©çš„å®Œæ•´ç¨‹å¼ç¢¼å¯ä»¥åœ¨[é€™è£¡](https://github.com/dean9703111/ithelp_30days/tree/master/day8)æ‰¾åˆ°å–”
* æˆ‘ä¹Ÿè²¼å¿ƒåœ°æŠŠæ˜¨å¤©çš„æŠŠæ˜¨å¤©çš„ç¨‹å¼ç¢¼æ‰“åŒ…æˆ[å£“ç¸®æª”](https://github.com/dean9703111/ithelp_30days/raw/master/sampleCode/day7_sample_code.zip)ï¼Œä½ å¯ä»¥ç”¨è£¡é¢ä¹¾æ·¨çš„ç’°å¢ƒä¾†å¯¦ä½œä»Šå¤©çš„åŠŸèƒ½å–”
    * è«‹è¨˜å¾—åœ¨çµ‚ç«¯æ©Ÿä¸‹æŒ‡ä»¤ **yarn** æ‰æœƒæŠŠä¹‹å‰çš„å¥—ä»¶å®‰è£

ğŸ“– åƒè€ƒè³‡æº
----
1. [\[JS\] è«‡è«‡ JavaScript ä¸­çš„éŒ¯èª¤è™•ç† Error Handling](https://pjchender.blogspot.com/2017/12/js-error-handling.html)
2. [ç‚ºä»€éº¼ç”¨ (æˆ–ä¸ç”¨) Puppeteer](https://michaelchen.tech/puppeteer/why-or-why-not-puppeteer/)
<br>

>*å…è²¬è²æ˜:æ–‡ç« æŠ€è¡“åƒ…æŠ“å–å…¬é–‹æ•¸æ“šä½œçˆ²ç ”ç©¶ï¼Œä»»ä½•çµ„ç¹”å’Œå€‹äººä¸å¾—ä»¥æ­¤æŠ€è¡“ç›œå–ä»–äººæ™ºæ…§è²¡ç”¢ã€é€ æˆç¶²ç«™æå®³ï¼Œå¦å‰‡ä¸€åˆ‡åæœç”±è©²çµ„ç¹”æˆ–å€‹äººæ‰¿æ“”ã€‚ä½œè€…ä¸æ‰¿æ“”ä»»ä½•æ³•å¾‹åŠé€£å¸¶è²¬ä»»ï¼*
### [Day9 çˆ¬èŸ²ç¬¬ä¸€æ­¥ï¼ŒFBå…ˆç™»å…¥](/day9/README.md)